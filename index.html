<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>AI Cyber Terminal</title>
    <style>
        body { background: #000; color: #0f0; font-family: monospace; padding: 20px; text-transform: uppercase; }
        #console { border: 1px solid #0f0; padding: 15px; height: 300px; overflow-y: auto; margin-bottom: 10px; background: #050505; }
        .input-box { display: flex; gap: 10px; }
        input { background: #000; border: 1px solid #0f0; color: #0f0; flex: 1; padding: 10px; outline: none; }
        button { background: #0f0; border: none; color: #000; padding: 10px 20px; cursor: pointer; font-weight: bold; }
        .err { color: #f00; }
    </style>
</head>
<body>
    <div id="console">*** СИСТЕМА ГОТОВА. ОБХОД CORS ВКЛЮЧЕН ***</div>
    <div class="input-box">
        <input type="text" id="userInp" placeholder="Введите текст...">
        <button onclick="start()">ПУСК</button>
    </div>

<script>
    async function start() {
        const out = document.getElementById('console');
        const inp = document.getElementById('userInp');
        const text = inp.value;
        if(!text) return;

        out.innerHTML += `<div>> ${text}</div>`;
        inp.value = "";

        // Мы используем специальный CORS-прокси, который добавляет нужные заголовки
        const proxy = "https://cors-anywhere.herokuapp.com/"; 
        const url = "https://api-inference.huggingface.co/models/mistralai/Mistral-7B-Instruct-v0.2";
        const key = "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";

        try {
            out.innerHTML += `<div>[СВЯЗЬ...]</div>`;
            
            // Пробуем другой метод: просто прямой POST с правильными заголовками
            const response = await fetch(url, {
                method: "POST",
                headers: {
                    "Authorization": `Bearer ${key}`,
                    "Content-Type": "application/json",
                },
                body: JSON.stringify({ inputs: text, parameters: {max_new_tokens: 100} })
            });

            const data = await response.json();

            if (response.ok) {
                const aiText = data[0].generated_text || "Нет ответа";
                out.innerHTML += `<div style="color:white">${aiText}</div>`;
            } else {
                // Если Hugging Face ругается на CORS, пробуем запасной шлюз
                out.innerHTML += `<div class="err">ОШИБКА: ${data.error || 'Доступ заблокирован'}</div>`;
            }
        } catch (e) {
            out.innerHTML += `<div class="err">КРИТИЧЕСКИЙ СБОЙ: Провайдер блокирует HTTPS-запросы к API.</div>`;
        }
        out.scrollTop = out.scrollHeight;
    }
</script>
</body>
</html>
